---
title: 网络设备入门笔记
---
## 交换机
交换机的作用是通过网线将多台计算机形成一个局域网， 交换机是在集线器的基础上优化而来，集线器的工作原理是把接收到的数据包通过广播的方式发送给插入集线器的所有计算机，在整个局域网中的所有计算机都会接收到这个数据包，并且判断数据包是否发送给自己的，如果是就接收，不是就丢掉。当局域网很小的时候，用集线器问题不大，但是当局域网的设备比较多的时候，每个计算机发的包都广播给集线器的所有端口，网络线路就会很频繁，形成网络风暴，性能就不好了。集线器是无脑的广播数据包，而交换机则更加智能化，交换机传输数据包会直接传输到指定的端口上去，不会每次都广播给所有端口。
交换机里面保存了一张 MAC 的地址表，记录计算机(或者其他设备)的 MAC 地址以及其插入交换机的端口位置，当交换机接受到数据包时，会根据数据包中的 MAC 地址在地址表中找到对应的端口，然后将数据包该端口转发到对应的计算中，所有就不需要将数据包广播给所有端口了。如果地址表中没有对应的记录，则将数据包广播到除了源端口之外的所有端口，然后把响应的端口写到地址表中。如果接收方 MAC 地址是一个广播地址，那么交换机会将包发送到除源端口之外的所有端口。
![网络-交换机](/images/网络-交换机.png)

## 路由器
路由器就是用来连接两个或多个不同的局域网的。路由器是基于网络层设计的，提供了路由与转发两种重要的机制，每个路由器中都有一个路由表和转发表，路由表用来决策路由，转发表用来转发分组。路由器收到一个数据包后，会检查其目的 IP 地址，然后查找路由表。查找到匹配的路由表项之后，路由器会根据该表项所指示的出接口信息和下一跳信息将数据包转发出去。


![网络-路由器](/images/网络-路由器.png)

## 交换机和路由器的区别
* 交换机工作于数据链路层，能识别 MAC 地址，根据 MAC 地址转发链路层数据帧，路由器位于网络层，能识别 IP 地址，根据 IP 地址转发分组；
* 交换机用于连接局域网，数据包在局域网内网的数据转发，路由器用于连接局域网和外网，数据包可以在不同局域网转发。

## NAT 网络
NAT 英文全称 Network Address Translation，中文翻译为网络地址转换，它是一种把内部私有网络地址转换成上一级对外输出的网络IP地址。虚拟系统借助 NAT(网络地址转换)功能，通过宿主机器所在的网络来访问公网。

## 虚拟网络
### 虚拟网桥(Bridge)
虚拟网桥可以看作是一个虚拟的交换机，可以配置 MAC 和 IP 地址，可以使用 veth-pair 虚拟设备(相当于网线)或者虚拟网卡 tun/tap 将不同的虚拟机连接到虚拟交换机组成一个虚拟的局域网(VLAN)。如果把网桥、虚拟机网段设置跟宿主机的同一个网段，则虚拟局域网跟宿主机局域网属于平行关系，那么在网络上可以把虚拟机看成一台真正的主机，如果网桥配置的网关跟宿主机不一样，则虚拟局域网跟宿主机的局域网属于两个隔开的网络，如果虚拟机想要通过宿主机访问外网，则需要宿主机开启 开启 IP forward 功能并配置 NAT 地址转换，才能连接到外网。Linux 可以使用 `brcti` 命令可以操作虚拟的网络。
![虚拟网桥](/images/虚拟网桥.png)

### 虚拟 NAT 
虚拟 NAT 会在宿主机中虚拟出一块网卡来，使得宿主机成为双网卡主机，虚拟网卡带有 NAT 功能，使得虚拟局域网内的虚拟机在对外访问时，使用的则是宿主机的IP地址，这样从外部网络来看，只能看到宿主机，完全看不到新建的虚拟局域网。虚拟 NAT 的缺点是虚拟机可以 ping 通宿主机，但是宿主机 ping 不通虚拟机。

### Host-only
在 Host-Only 模式下，虚拟网络是一个全封闭的网络，只能能够与宿主机通信。 Host-Only 网络和 NAT 网络很相似，不同的地方就是 Host-Only 网络没有 NAT 服务，所以虚拟网络不能连接到通过宿主机连到外网，Host-Only 的宗旨就是建立一个与外界隔绝的内部网络，来提高内网的安全性。


## 参考链接
1、https://blog.csdn.net/qq_21187515/article/details/119375576