---
title: Docker 入门笔记
---
## 2. Docker 网络原理
Docker 服务进程启动时，默认会创建一个 docker0 虚拟网桥，也就是虚拟交换机，docker0 的默认 IP 地址为172.17.0.1，子网掩码为255.255.0.0。
在 Linux 系统中可以使用命令 `brctl show` 可以查看虚拟网桥，如果命令不存在，需要安装 `bridge-utils` 软件。

### 2.1 Docker 网络模式
Docker 默认支持4种网络工作模式，如下：
* Host 模式：容器内部网络空间共享主机的空间，效果类似直接在宿主机上启动一个进程，端口信息和宿主机共用；
* Container 模式：启动时使用参数 -net = container:[名称|id] 指定当前启动容器与 -net 指定的已存在的容器共享网络，使用其网络命名空间。
* None 模式：该模式关闭了容器的网络功能，但是还会保留网络命名空间，只是不创建虚拟网卡和相关网络配置。
* Bridge 模式：该模式是 Docker 默认网络模式，容器启动时会将容器连接到一个 docker0 虚拟网桥，通过 docker0 网桥以及宿主机 Iptables nat 表配置与宿主机通信。

#### 2.1.1 Container 模式


#### 2.1.2 Bridge 模式
Bridge 网桥是虚拟交换机，工作于数据链路层，主要的功能是根据 MAC 地址将数据包转发到网桥的不同端口上。Docker 网桥模式的示意图如下：
![docker-网桥模式示意图](/images/docker-网桥模式示意图.png)

Docker 创建启动一个容器的时候，会在宿主机中创建一对虚拟接口/网卡 Veth Pair，虚拟端口的一端桥接到 docker0 网桥，在宿主机中使用 `ifconfig | grep veth
` 可以查看到，其命名的方式前缀固定 Veth 后缀随机，如 veth080517f，虚拟端口的另一端连接到新启动的容器内部网络中，因为容器内跟宿主机的网络命名空间是隔离的，所其名字会被命名给 eth0，然后从网桥的可用地址段中获取一个空闲地址分配给容器的 eth0。

















## 参考链接
1、https://blog.csdn.net/m0_49654228/article/details/117446963